<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœºå™¨äººåŠ©æ‰‹åŠŸèƒ½æµ‹è¯•</title>
    <link rel="stylesheet" href="css/word-book.css">
    <style>
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .test-title {
            color: #5a67d8;
            font-size: 1.5rem;
            margin-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            margin: 5px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <header class="test-section">
            <h1>ğŸ¤– æœºå™¨äººåŠ©æ‰‹åŠŸèƒ½å…¨é¢æµ‹è¯•</h1>
            <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•æœºå™¨äººåŠ©æ‰‹çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        </header>
        
        <!-- 1. æ™ºèƒ½å¯¹è¯ç³»ç»Ÿæµ‹è¯• -->
        <section class="test-section">
            <h2 class="test-title">1. æ™ºèƒ½å¯¹è¯ç³»ç»Ÿæµ‹è¯•</h2>
            <button class="test-btn" onclick="testDialogSystem()">æµ‹è¯•å¯¹è¯åŠŸèƒ½</button>
            <button class="test-btn" onclick="testContextHelp()">æµ‹è¯•æƒ…å¢ƒæ„ŸçŸ¥</button>
            <button class="test-btn" onclick="testLearningFeedback()">æµ‹è¯•å­¦ä¹ åé¦ˆ</button>
            <button class="test-btn" onclick="testPersonalizedAdvice()">æµ‹è¯•ä¸ªæ€§åŒ–å»ºè®®</button>
            <div id="dialog-status" class="status info">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
        </section>
        
        <!-- 2. è¯­éŸ³åˆæˆåŠŸèƒ½æµ‹è¯• -->
        <section class="test-section">
            <h2 class="test-title">2. è¯­éŸ³åˆæˆåŠŸèƒ½æµ‹è¯•</h2>
            <button class="test-btn" onclick="testSpeechSynthesis()">æµ‹è¯•è¯­éŸ³åˆæˆ</button>
            <button class="test-btn" onclick="testBilingualSpeech()">æµ‹è¯•åŒè¯­æ”¯æŒ</button>
            <button class="test-btn" onclick="testPronunciationHelp()">æµ‹è¯•å‘éŸ³ç»ƒä¹ </button>
            <button class="test-btn" onclick="testSpeechControl()">æµ‹è¯•è¯­éŸ³æ§åˆ¶</button>
            <div id="speech-status" class="status info">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
        </section>
        
        <!-- 3. æƒ…æ„Ÿäº¤äº’ç³»ç»Ÿæµ‹è¯• -->
        <section class="test-section">
            <h2 class="test-title">3. æƒ…æ„Ÿäº¤äº’ç³»ç»Ÿæµ‹è¯•</h2>
            <button class="test-btn" onclick="testEmotion('happy')">æµ‹è¯•å¼€å¿ƒè¡¨æƒ…</button>
            <button class="test-btn" onclick="testEmotion('excited')">æµ‹è¯•å…´å¥‹è¡¨æƒ…</button>
            <button class="test-btn" onclick="testEmotion('thinking')">æµ‹è¯•æ€è€ƒè¡¨æƒ…</button>
            <button class="test-btn" onclick="testAnimations()">æµ‹è¯•åŠ¨ç”»æ•ˆæœ</button>
            <div id="emotion-status" class="status info">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
        </section>
        
        <!-- 4. å­¦ä¹ å¸®åŠ©ç³»ç»Ÿæµ‹è¯• -->
        <section class="test-section">
            <h2 class="test-title">4. å­¦ä¹ å¸®åŠ©ç³»ç»Ÿæµ‹è¯•</h2>
            <button class="test-btn" onclick="testModeGuidance()">æµ‹è¯•åˆ†æ¨¡å¼æŒ‡å¯¼</button>
            <button class="test-btn" onclick="testLearningTips()">æµ‹è¯•å­¦ä¹ æŠ€å·§</button>
            <button class="test-btn" onclick="testProgressTracking()">æµ‹è¯•è¿›åº¦è·Ÿè¸ª</button>
            <button class="test-btn" onclick="testWordAssociation()">æµ‹è¯•å•è¯è”æƒ³</button>
            <div id="help-status" class="status info">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
        </section>
        
        <!-- ç»¼åˆåŠŸèƒ½æµ‹è¯• -->
        <section class="test-section">
            <h2 class="test-title">5. ç»¼åˆåŠŸèƒ½æµ‹è¯•</h2>
            <button class="test-btn" onclick="testCompleteWorkflow()">æµ‹è¯•å®Œæ•´å·¥ä½œæµ</button>
            <button class="test-btn" onclick="testErrorHandling()">æµ‹è¯•é”™è¯¯å¤„ç†</button>
            <button class="test-btn" onclick="testAllFeatures()">æµ‹è¯•æ‰€æœ‰åŠŸèƒ½</button>
            <div id="comprehensive-status" class="status info">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
        </section>
    </div>

    <!-- æœºå™¨äººåŠ©æ‰‹ç»„ä»¶ -->
    <div class="robot-assistant" id="robotAssistant">
        <div class="robot-avatar">
            <div class="robot-face">
                <div class="robot-eyes">
                    <div class="eye left"></div>
                    <div class="eye right"></div>
                </div>
                <div class="robot-mouth"></div>
            </div>
        </div>
        <div class="robot-message" id="robotMessage">
            <div class="message-bubble" id="messageBubble">
                å‡†å¤‡å¼€å§‹åŠŸèƒ½æµ‹è¯•ï¼
            </div>
        </div>
        <div class="robot-controls">
            <button class="robot-btn" id="robotHelpBtn" title="å¸®åŠ©">ğŸ’¡</button>
            <button class="robot-btn" id="robotTipBtn" title="æç¤º">ğŸ’¬</button>
            <button class="robot-btn" id="robotMicBtn" title="è¯­éŸ³è¯†åˆ«">ğŸ¤</button>
            <button class="robot-btn" id="robotAdviceBtn" title="å»ºè®®">ğŸ“š</button>
            <button class="robot-btn" id="robotGameBtn" title="æ¸¸æˆ">ğŸ®</button>
            <button class="robot-btn" id="robotVoiceBtn" title="è¯­éŸ³">ğŸ”Š</button>
            <button class="robot-btn" id="robotCloseBtn" title="å…³é—­">âŒ</button>
        </div>
    </div>

    <div class="robot-fab" id="robotFab">
        <div class="fab-icon">ğŸ¤–</div>
    </div>

    <script src="js/word-database.js"></script>
    <script src="js/word-book.js"></script>
    <script>
        let testRobot;
        let testResults = {
            dialog: false,
            speech: false,
            emotion: false,
            help: false,
            comprehensive: false
        };

        // ç­‰å¾…æœºå™¨äººåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                testRobot = robotAssistant;
                if (testRobot) {
                    testRobot.show();
                    updateStatus('dialog-status', 'æœºå™¨äººåŠ©æ‰‹å·²å°±ç»ªï¼Œå¼€å§‹æµ‹è¯•ï¼', 'success');
                } else {
                    updateStatus('dialog-status', 'æœºå™¨äººåŠ©æ‰‹åˆå§‹åŒ–å¤±è´¥ï¼', 'error');
                }
            }, 1000);
        });

        function updateStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = message;
                element.className = `status ${type}`;
            }
        }

        // 1. æ™ºèƒ½å¯¹è¯ç³»ç»Ÿæµ‹è¯•
        function testDialogSystem() {
            if (!testRobot) {
                updateStatus('dialog-status', 'æœºå™¨äººåŠ©æ‰‹æœªåˆå§‹åŒ–ï¼', 'error');
                return;
            }
            
            try {
                // æµ‹è¯•æ¶ˆæ¯è·å–
                const welcomeMsg = testRobot.getRandomMessage('welcome');
                const encouragementMsg = testRobot.getRandomMessage('encouragement');
                
                updateStatus('dialog-status', 
                    `âœ… æ¶ˆæ¯ç³»ç»Ÿæ­£å¸¸\næ¬¢è¿è¯­: ${welcomeMsg}\né¼“åŠ±è¯­: ${encouragementMsg}`, 
                    'success'
                );
                
                testRobot.updateMessage("å¯¹è¯ç³»ç»Ÿæµ‹è¯•æˆåŠŸï¼æ‰€æœ‰æ¶ˆæ¯ç±»å‹éƒ½èƒ½æ­£å¸¸è·å–ã€‚");
            } catch (error) {
                updateStatus('dialog-status', `âŒ å¯¹è¯ç³»ç»Ÿæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testContextHelp() {
            try {
                // æ¨¡æ‹Ÿä¸åŒé¡µé¢
                const originalTab = document.querySelector('.tab-btn.active');
                
                testRobot.provideContextHelp();
                updateStatus('dialog-status', 'âœ… æƒ…å¢ƒæ„ŸçŸ¥åŠŸèƒ½æ­£å¸¸ï¼Œèƒ½å¤Ÿè¯†åˆ«å½“å‰é¡µé¢å¹¶æä¾›é’ˆå¯¹æ€§å¸®åŠ©', 'success');
            } catch (error) {
                updateStatus('dialog-status', `âŒ æƒ…å¢ƒæ„ŸçŸ¥æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testLearningFeedback() {
            try {
                // æ¨¡æ‹Ÿå­¦ä¹ åé¦ˆ
                testRobot.onWordLearned({ word: 'test', chinese: 'æµ‹è¯•' });
                setTimeout(() => {
                    testRobot.onTestCompleted(8, 10);
                    updateStatus('dialog-status', 'âœ… å­¦ä¹ åé¦ˆåŠŸèƒ½æ­£å¸¸ï¼Œç¥è´ºå’Œè¯„ä»·ç³»ç»Ÿå·¥ä½œæ­£å¸¸', 'success');
                }, 2000);
            } catch (error) {
                updateStatus('dialog-status', `âŒ å­¦ä¹ åé¦ˆæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testPersonalizedAdvice() {
            try {
                const suggestion = testRobot.getStudySuggestion();
                updateStatus('dialog-status', `âœ… ä¸ªæ€§åŒ–å»ºè®®æ­£å¸¸: ${suggestion}`, 'success');
            } catch (error) {
                updateStatus('dialog-status', `âŒ ä¸ªæ€§åŒ–å»ºè®®æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // 2. è¯­éŸ³åˆæˆåŠŸèƒ½æµ‹è¯•
        function testSpeechSynthesis() {
            if (!window.speechSynthesis) {
                updateStatus('speech-status', 'âŒ æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ', 'error');
                return;
            }
            
            try {
                testRobot.speak("è¯­éŸ³åˆæˆåŠŸèƒ½æµ‹è¯•");
                updateStatus('speech-status', 'âœ… è¯­éŸ³åˆæˆåŠŸèƒ½å¯åŠ¨æˆåŠŸï¼Œè¯·æ³¨æ„å¬å£°éŸ³', 'success');
            } catch (error) {
                updateStatus('speech-status', `âŒ è¯­éŸ³åˆæˆæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testBilingualSpeech() {
            try {
                testRobot.speak("Hello", 'en-US');
                setTimeout(() => {
                    testRobot.speak("ä½ å¥½", 'zh-CN');
                    updateStatus('speech-status', 'âœ… åŒè¯­è¯­éŸ³åˆæˆåŠŸèƒ½æ­£å¸¸', 'success');
                }, 3000);
            } catch (error) {
                updateStatus('speech-status', `âŒ åŒè¯­è¯­éŸ³æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testPronunciationHelp() {
            try {
                const testWord = { word: 'apple', phonetic: '/ËˆÃ¦pl/' };
                testRobot.helpWithPronunciation(testWord);
                updateStatus('speech-status', 'âœ… å‘éŸ³ç»ƒä¹ åŠŸèƒ½æ­£å¸¸ï¼Œæ­£åœ¨æ’­æ”¾å•è¯å‘éŸ³', 'success');
            } catch (error) {
                updateStatus('speech-status', `âŒ å‘éŸ³ç»ƒä¹ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testSpeechControl() {
            try {
                testRobot.toggleVoice();
                setTimeout(() => {
                    testRobot.toggleVoice();
                    updateStatus('speech-status', 'âœ… è¯­éŸ³æ§åˆ¶åŠŸèƒ½æ­£å¸¸', 'success');
                }, 1000);
            } catch (error) {
                updateStatus('speech-status', `âŒ è¯­éŸ³æ§åˆ¶æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // 3. æƒ…æ„Ÿäº¤äº’ç³»ç»Ÿæµ‹è¯•
        function testEmotion(emotion) {
            try {
                testRobot.setEmotion(emotion);
                updateStatus('emotion-status', `âœ… ${emotion}è¡¨æƒ…è®¾ç½®æˆåŠŸ`, 'success');
            } catch (error) {
                updateStatus('emotion-status', `âŒ è¡¨æƒ…æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testAnimations() {
            try {
                testRobot.animateRobot();
                testRobot.celebrate();
                updateStatus('emotion-status', 'âœ… åŠ¨ç”»ç³»ç»Ÿæ­£å¸¸ï¼Œçœ¨çœ¼ã€è¯´è¯ã€åº†ç¥åŠ¨ç”»éƒ½èƒ½æ­£å¸¸æ’­æ”¾', 'success');
            } catch (error) {
                updateStatus('emotion-status', `âŒ åŠ¨ç”»æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // 4. å­¦ä¹ å¸®åŠ©ç³»ç»Ÿæµ‹è¯•
        function testModeGuidance() {
            try {
                const advice = testRobot.getModeSpecificAdvice('study');
                updateStatus('help-status', `âœ… åˆ†æ¨¡å¼æŒ‡å¯¼æ­£å¸¸: ${advice}`, 'success');
            } catch (error) {
                updateStatus('help-status', `âŒ åˆ†æ¨¡å¼æŒ‡å¯¼æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testLearningTips() {
            try {
                testRobot.giveTip();
                updateStatus('help-status', 'âœ… å­¦ä¹ æŠ€å·§æç¤ºåŠŸèƒ½æ­£å¸¸', 'success');
            } catch (error) {
                updateStatus('help-status', `âŒ å­¦ä¹ æŠ€å·§æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testProgressTracking() {
            try {
                testRobot.onStudyProgress(5, 10);
                testRobot.onStudyProgress(10, 10);
                updateStatus('help-status', 'âœ… è¿›åº¦è·Ÿè¸ªåŠŸèƒ½æ­£å¸¸ï¼Œèƒ½å¤Ÿæ­£ç¡®è¯†åˆ«é‡Œç¨‹ç¢‘', 'success');
            } catch (error) {
                updateStatus('help-status', `âŒ è¿›åº¦è·Ÿè¸ªæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testWordAssociation() {
            try {
                const testWord = { 
                    word: 'book', 
                    mnemonic: 'å®åº“é‡Œçš„ä¹¦', 
                    association: 'ä¹¦æ˜¯çŸ¥è¯†çš„å®åº“' 
                };
                const association = testRobot.getWordAssociation(testWord);
                updateStatus('help-status', `âœ… å•è¯è”æƒ³åŠŸèƒ½æ­£å¸¸: ${association}`, 'success');
            } catch (error) {
                updateStatus('help-status', `âŒ å•è¯è”æƒ³æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // 5. ç»¼åˆåŠŸèƒ½æµ‹è¯•
        function testCompleteWorkflow() {
            try {
                // å®Œæ•´å·¥ä½œæµæµ‹è¯•
                testRobot.provideContextHelp();
                setTimeout(() => {
                    testRobot.giveTip();
                    setTimeout(() => {
                        testRobot.setEmotion('excited');
                        updateStatus('comprehensive-status', 'âœ… å®Œæ•´å·¥ä½œæµæµ‹è¯•æˆåŠŸ', 'success');
                    }, 2000);
                }, 2000);
            } catch (error) {
                updateStatus('comprehensive-status', `âŒ å·¥ä½œæµæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testErrorHandling() {
            try {
                // æµ‹è¯•é”™è¯¯å¤„ç†
                testRobot.speak(null); // åº”è¯¥è¢«ä¼˜é›…å¤„ç†
                testRobot.setEmotion('invalid'); // åº”è¯¥è¢«ä¼˜é›…å¤„ç†
                updateStatus('comprehensive-status', 'âœ… é”™è¯¯å¤„ç†æœºåˆ¶æ­£å¸¸å·¥ä½œ', 'success');
            } catch (error) {
                updateStatus('comprehensive-status', `âŒ é”™è¯¯å¤„ç†æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testAllFeatures() {
            let allPassed = true;
            const tests = [
                testDialogSystem,
                testSpeechSynthesis,
                testEmotion.bind(null, 'happy'),
                testModeGuidance
            ];
            
            tests.forEach((test, index) => {
                try {
                    test();
                } catch (error) {
                    allPassed = false;
                    updateStatus('comprehensive-status', `âŒ æµ‹è¯• ${index + 1} å¤±è´¥: ${error.message}`, 'error');
                }
            });
            
            if (allPassed) {
                updateStatus('comprehensive-status', 'ğŸ‰ æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼æœºå™¨äººåŠ©æ‰‹åŠŸèƒ½å®Œæ•´ï¼', 'success');
                testRobot.celebrate();
            }
        }
    </script>
</body>
</html>