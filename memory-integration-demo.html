<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemOSè®°å¿†ç®¡ç†é›†æˆæ¼”ç¤º</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .demo-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .demo-header h1 {
            margin: 0;
            font-size: 3em;
            font-weight: 300;
            animation: fadeInDown 1s ease;
        }

        .demo-header p {
            margin: 20px 0 0;
            font-size: 1.3em;
            opacity: 0.9;
            animation: fadeInUp 1s ease 0.3s both;
        }

        .demo-content {
            padding: 40px;
        }

        .memory-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .status-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .status-card.active {
            border-color: #28a745;
            background: #f0fff4;
        }

        .status-card.inactive {
            border-color: #dc3545;
            background: #fff5f5;
        }

        .status-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .status-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .status-description {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .memory-functions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .function-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .function-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .function-icon {
            font-size: 2.5em;
            margin-bottom: 20px;
            display: block;
        }

        .function-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .function-description {
            color: #666;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            width: 100%;
        }

        .test-button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .memory-interface {
            background: #2d3748;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
            color: #e2e8f0;
        }

        .interface-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid #4a5568;
        }

        .interface-tab {
            background: none;
            border: none;
            color: #a0aec0;
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .interface-tab.active {
            color: #e2e8f0;
            border-bottom-color: #667eea;
        }

        .interface-content {
            display: none;
        }

        .interface-content.active {
            display: block;
        }

        .memory-display {
            background: #1a202c;
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .memory-item {
            background: #2d3748;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .memory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .memory-type {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
        }

        .memory-time {
            font-size: 12px;
            color: #a0aec0;
        }

        .memory-content {
            color: #e2e8f0;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        .test-results {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            max-height: 300px;
            overflow-y: auto;
        }

        .result-item {
            background: white;
            border-left: 4px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .result-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .result-content {
            color: #666;
            line-height: 1.4;
        }

        .search-box {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            border: 2px solid #e0e0e0;
        }

        .search-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 15px;
            transition: all 0.3s;
        }

        .search-button:hover {
            background: #5a67d8;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .demo-header h1 {
                font-size: 2em;
            }
            
            .memory-functions,
            .memory-status {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <header class="demo-header">
            <h1>ğŸ§  MemOSè®°å¿†ç®¡ç†é›†æˆ</h1>
            <p>AIå°è¯´åˆ›ä½œç³»ç»Ÿçš„æ™ºèƒ½è®°å¿†åŠŸèƒ½æ¼”ç¤º</p>
        </header>

        <div class="demo-content">
            <!-- è®°å¿†çŠ¶æ€ -->
            <div class="memory-status">
                <div class="status-card" id="memosStatus">
                    <div class="status-icon">â˜ï¸</div>
                    <div class="status-title">MemOSè¿æ¥</div>
                    <div class="status-description">æ£€æµ‹MemOSè®°å¿†ç®¡ç†æœåŠ¡</div>
                </div>

                <div class="status-card" id="memoryStats">
                    <div class="status-icon">ğŸ“Š</div>
                    <div class="status-title">è®°å¿†ç»Ÿè®¡</div>
                    <div class="status-description" id="statsDescription">åŠ è½½è®°å¿†æ•°æ®...</div>
                </div>

                <div class="status-card" id="personalization">
                    <div class="status-icon">ğŸ¯</div>
                    <div class="status-title">ä¸ªæ€§åŒ–åˆ†æ</div>
                    <div class="status-description">ç”¨æˆ·åå¥½å’Œå†™ä½œé£æ ¼åˆ†æ</div>
                </div>
            </div>

            <!-- æœç´¢æµ‹è¯• -->
            <div class="search-box">
                <input type="text" class="search-input" id="memorySearch" placeholder="æœç´¢è®°å¿†å†…å®¹...">
                <button class="search-button" onclick="searchMemory()">ğŸ” æœç´¢è®°å¿†</button>
            </div>

            <!-- è®°å¿†åŠŸèƒ½ -->
            <div class="memory-functions">
                <div class="function-card">
                    <span class="function-icon">ğŸ’¾</span>
                    <h3 class="function-title">ä¿å­˜å¯¹è¯</h3>
                    <p class="function-description">å°†ç”¨æˆ·å¯¹è¯å’ŒAIå“åº”ä¿å­˜åˆ°è®°å¿†ä¸­ï¼Œæ”¯æŒæŒä¹…åŒ–å­˜å‚¨</p>
                    <button class="test-button" onclick="testSaveConversation()">æµ‹è¯•ä¿å­˜å¯¹è¯</button>
                </div>

                <div class="function-card">
                    <span class="function-icon">ğŸ”</span>
                    <h3 class="function-title">æœç´¢è®°å¿†</h3>
                    <p class="function-description">åŸºäºå…³é”®è¯æœç´¢ç›¸å…³çš„è®°å¿†å†…å®¹ï¼Œæ™ºèƒ½åŒ¹é…</p>
                    <button class="test-button" onclick="testSearchMemory()">æµ‹è¯•æœç´¢åŠŸèƒ½</button>
                </div>

                <div class="function-card">
                    <span class="function-icon">ğŸ“</span>
                    <h3 class="function-title">åˆ›ä½œè®°å¿†</h3>
                    <p class="function-description">ä¿å­˜æ•…äº‹ã€è§’è‰²ã€è®¾ç½®ç­‰åˆ›ä½œç›¸å…³è®°å¿†</p>
                    <button class="test-button" onclick="testCreativeMemory()">æµ‹è¯•åˆ›ä½œè®°å¿†</button>
                </div>

                <div class="function-card">
                    <span class="function-icon">ğŸ¨</span>
                    <h3 class="function-title">é£æ ¼åˆ†æ</h3>
                    <p class="function-description">åˆ†æç”¨æˆ·å†™ä½œé£æ ¼ï¼Œæä¾›ä¸ªæ€§åŒ–å»ºè®®</p>
                    <button class="test-button" onclick="testStyleAnalysis()">æµ‹è¯•é£æ ¼åˆ†æ</button>
                </div>

                <div class="function-card">
                    <span class="function-icon">âš™ï¸</span>
                    <h3 class="function-title">ç”¨æˆ·åå¥½</h3>
                    <p class="function-description">è®°å½•å’Œç®¡ç†ç”¨æˆ·çš„åˆ›ä½œåå¥½è®¾ç½®</p>
                    <button class="test-button" onclick="testUserPreferences()">æµ‹è¯•ç”¨æˆ·åå¥½</button>
                </div>

                <div class="function-card">
                    <span class="function-icon">ğŸ—‚ï¸</span>
                    <h3 class="function-title">å¯¹è¯å†å²</h3>
                    <p class="function-description">è·å–å®Œæ•´çš„å¯¹è¯å†å²è®°å½•</p>
                    <button class="test-button" onclick="testConversationHistory()">æµ‹è¯•å¯¹è¯å†å²</button>
                </div>
            </div>

            <!-- è®°å¿†ç•Œé¢ -->
            <div class="memory-interface">
                <div class="interface-tabs">
                    <button class="interface-tab active" onclick="switchInterfaceTab('search')">æœç´¢ç»“æœ</button>
                    <button class="interface-tab" onclick="switchInterfaceTab('creative')">åˆ›ä½œè®°å¿†</button>
                    <button class="interface-tab" onclick="switchInterfaceTab('preferences')">ç”¨æˆ·åå¥½</button>
                </div>

                <div class="interface-content active" id="search-content">
                    <div class="memory-display" id="searchResults">
                        <p style="text-align: center; color: #a0aec0;">æœç´¢è®°å¿†åï¼Œç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
                    </div>
                </div>

                <div class="interface-content" id="creative-content">
                    <div class="memory-display" id="creativeMemories">
                        <p style="text-align: center; color: #a0aec0;">åˆ›ä½œè®°å¿†å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
                    </div>
                </div>

                <div class="interface-content" id="preferences-content">
                    <div class="memory-display" id="userPreferences">
                        <p style="text-align: center; color: #a0aec0;">ç”¨æˆ·åå¥½å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
                    </div>
                </div>
            </div>

            <!-- æµ‹è¯•ç»“æœ -->
            <div class="test-results">
                <h3>ğŸ“‹ æµ‹è¯•ç»“æœ</h3>
                <div id="testResults">
                    <div class="result-item">
                        <div class="result-title">ç³»ç»Ÿåˆå§‹åŒ–</div>
                        <div class="result-content">ç­‰å¾…æµ‹è¯•ç»“æœ...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½å¿…è¦çš„è„šæœ¬ -->
    <script src="memory-manager.js"></script>

    <script>
        let memoryManager;
        let testResults = [];

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            await initializeMemoryDemo();
        });

        async function initializeMemoryDemo() {
            try {
                // åˆå§‹åŒ–è®°å¿†ç®¡ç†å™¨
                memoryManager = new MemoryManager();
                
                // ç­‰å¾…åˆå§‹åŒ–å®Œæˆ
                setTimeout(() => {
                    updateMemoryStatus();
                    loadInitialData();
                }, 2000);
                
            } catch (error) {
                console.error('è®°å¿†ç®¡ç†æ¼”ç¤ºåˆå§‹åŒ–å¤±è´¥:', error);
                addTestResult('åˆå§‹åŒ–å¤±è´¥', error.message, 'error');
            }
        }

        function updateMemoryStatus() {
            const stats = memoryManager.getMemoryStats();
            
            // æ›´æ–°MemOSçŠ¶æ€
            const memosStatus = document.getElementById('memosStatus');
            if (stats.isMemOSAvailable) {
                memosStatus.className = 'status-card active';
                memosStatus.querySelector('.status-icon').textContent = 'âœ…';
                memosStatus.querySelector('.status-description').textContent = 'MemOSè®°å¿†ç®¡ç†å·²è¿æ¥';
            } else {
                memosStatus.className = 'status-card inactive';
                memosStatus.querySelector('.status-icon').textContent = 'âš ï¸';
                memosStatus.querySelector('.status-description').textContent = 'ä½¿ç”¨æœ¬åœ°å­˜å‚¨æ›¿ä»£';
            }
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            const statsDescription = `
                å¯¹è¯: ${stats.conversations}æ¡ | 
                æ•…äº‹: ${stats.stories}ä¸ª | 
                è§’è‰²: ${stats.characters}ä¸ª | 
                æœ€åæ›´æ–°: ${new Date(stats.lastUpdated).toLocaleString()}
            `;
            document.getElementById('statsDescription').textContent = statsDescription;
        }

        async function loadInitialData() {
            try {
                // åŠ è½½ä¸€äº›ç¤ºä¾‹æ•°æ®
                await loadCreativeMemories();
                await loadUserPreferences();
                addTestResult('æ•°æ®åŠ è½½', 'åˆå§‹è®°å¿†æ•°æ®å·²åŠ è½½', 'success');
            } catch (error) {
                addTestResult('æ•°æ®åŠ è½½å¤±è´¥', error.message, 'error');
            }
        }

        async function loadCreativeMemories() {
            const memories = await memoryManager.getCreativeMemory('stories', 10);
            const container = document.getElementById('creativeMemories');
            
            if (memories.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #a0aec0;">æš‚æ— åˆ›ä½œè®°å¿†</p>';
                return;
            }
            
            container.innerHTML = memories.map(memory => `
                <div class="memory-item">
                    <div class="memory-header">
                        <span class="memory-type">åˆ›ä½œè®°å¿†</span>
                        <span class="memory-time">${new Date(memory.timestamp).toLocaleString()}</span>
                    </div>
                    <div class="memory-content">${JSON.stringify(memory.content, null, 2)}</div>
                </div>
            `).join('');
        }

        async function loadUserPreferences() {
            const preferences = await memoryManager.getUserPreferences();
            const container = document.getElementById('userPreferences');
            
            if (Object.keys(preferences).length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #a0aec0;">æš‚æ— ç”¨æˆ·åå¥½è®¾ç½®</p>';
                return;
            }
            
            container.innerHTML = Object.entries(preferences).map(([key, value]) => `
                <div class="memory-item">
                    <div class="memory-header">
                        <span class="memory-type">åå¥½è®¾ç½®</span>
                        <span class="memory-time">${key}</span>
                    </div>
                    <div class="memory-content">${JSON.stringify(value)}</div>
                </div>
            `).join('');
        }

        function switchInterfaceTab(tabName) {
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.interface-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // æ›´æ–°å†…å®¹æ˜¾ç¤º
            document.querySelectorAll('.interface-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName + '-content').classList.add('active');
        }

        async function searchMemory() {
            const query = document.getElementById('memorySearch').value.trim();
            if (!query) return;
            
            addTestResult('æœç´¢è®°å¿†', `æœç´¢: "${query}"`, 'info');
            
            try {
                const results = await memoryManager.searchRelevantMemory(query);
                const container = document.getElementById('searchResults');
                
                if (results.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #a0aec0;">æœªæ‰¾åˆ°ç›¸å…³è®°å¿†</p>';
                    addTestResult('æœç´¢ç»“æœ', 'æœªæ‰¾åˆ°ç›¸å…³è®°å¿†', 'warning');
                } else {
                    container.innerHTML = results.map(memory => `
                        <div class="memory-item">
                            <div class="memory-header">
                                <span class="memory-type">${memory.type}</span>
                                <span class="memory-time">${new Date(memory.timestamp).toLocaleString()}</span>
                            </div>
                            <div class="memory-content">ç›¸å…³æ€§: ${(memory.relevance * 100).toFixed(1)}%<br>${memory.content}</div>
                        </div>
                    `).join('');
                    
                    addTestResult('æœç´¢ç»“æœ', `æ‰¾åˆ° ${results.length} æ¡ç›¸å…³è®°å¿†`, 'success');
                }
            } catch (error) {
                addTestResult('æœç´¢å¤±è´¥', error.message, 'error');
            }
        }

        async function testSaveConversation() {
            addTestResult('ä¿å­˜å¯¹è¯', 'æµ‹è¯•å¯¹è¯ä¿å­˜åŠŸèƒ½', 'info');
            
            try {
                await memoryManager.saveConversation('æµ‹è¯•ç”¨æˆ·æ¶ˆæ¯', 'æµ‹è¯•AIå“åº”');
                addTestResult('ä¿å­˜æˆåŠŸ', 'å¯¹è¯å·²ä¿å­˜åˆ°è®°å¿†', 'success');
            } catch (error) {
                addTestResult('ä¿å­˜å¤±è´¥', error.message, 'error');
            }
        }

        async function testSearchMemory() {
            const testQueries = ['æ•…äº‹åˆ›ä½œ', 'è§’è‰²è®¾å®š', 'å†™ä½œé£æ ¼', 'å¥‡å¹»å°è¯´'];
            const randomQuery = testQueries[Math.floor(Math.random() * testQueries.length)];
            
            document.getElementById('memorySearch').value = randomQuery;
            await searchMemory();
        }

        async function testCreativeMemory() {
            addTestResult('åˆ›ä½œè®°å¿†', 'æµ‹è¯•åˆ›ä½œè®°å¿†ä¿å­˜', 'info');
            
            try {
                const testMemory = {
                    title: 'æµ‹è¯•æ•…äº‹',
                    genre: 'fantasy',
                    characters: ['æµ‹è¯•è§’è‰²1', 'æµ‹è¯•è§’è‰²2'],
                    plot: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ•…äº‹çš„æƒ…èŠ‚'
                };
                
                await memoryManager.saveCreativeMemory('story', testMemory);
                addTestResult('ä¿å­˜æˆåŠŸ', 'åˆ›ä½œè®°å¿†å·²ä¿å­˜', 'success');
                
                // é‡æ–°åŠ è½½åˆ›ä½œè®°å¿†
                await loadCreativeMemories();
            } catch (error) {
                addTestResult('ä¿å­˜å¤±è´¥', error.message, 'error');
            }
        }

        async function testStyleAnalysis() {
            addTestResult('é£æ ¼åˆ†æ', 'æµ‹è¯•å†™ä½œé£æ ¼åˆ†æ', 'info');
            
            try {
                const testText = 'è¿™æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•å†™ä½œé£æ ¼åˆ†æçš„ç¤ºä¾‹æ–‡æœ¬ã€‚å®ƒåŒ…å«äº†ä¸€äº›è¯æ±‡å’Œå¥å¼ï¼Œç”¨äºåˆ†æç”¨æˆ·çš„å†™ä½œç‰¹ç‚¹å’Œåå¥½ã€‚';
                const analysis = await memoryManager.analyzeWritingStyle(testText);
                
                addTestResult('åˆ†æå®Œæˆ', `å­—æ•°: ${analysis.wordCount}, å¤æ‚åº¦: ${analysis.complexity}, è¯­è°ƒ: ${analysis.tone}`, 'success');
            } catch (error) {
                addTestResult('åˆ†æå¤±è´¥', error.message, 'error');
            }
        }

        async function testUserPreferences() {
            addTestResult('ç”¨æˆ·åå¥½', 'æµ‹è¯•ç”¨æˆ·åå¥½ç®¡ç†', 'info');
            
            try {
                const testPreferences = {
                    favoriteGenre: 'fantasy',
                    writingStyle: 'descriptive',
                    autoSave: true,
                    theme: 'dark'
                };
                
                await memoryManager.saveUserPreferences(testPreferences);
                addTestResult('åå¥½ä¿å­˜', 'ç”¨æˆ·åå¥½å·²æ›´æ–°', 'success');
                
                // é‡æ–°åŠ è½½åå¥½
                await loadUserPreferences();
            } catch (error) {
                addTestResult('åå¥½ä¿å­˜å¤±è´¥', error.message, 'error');
            }
        }

        async function testConversationHistory() {
            addTestResult('å¯¹è¯å†å²', 'è·å–å®Œæ•´å¯¹è¯å†å²', 'info');
            
            try {
                const history = await memoryManager.getFullConversation();
                addTestResult('å†å²è·å–', `è·å–åˆ° ${history.length} æ¡å¯¹è¯è®°å½•`, 'success');
            } catch (error) {
                addTestResult('å†å²è·å–å¤±è´¥', error.message, 'error');
            }
        }

        function addTestResult(title, description, type = 'info') {
            const container = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            
            const resultItem = document.createElement('div');
            resultItem.className = 'result-item';
            resultItem.innerHTML = `
                <div class="result-title">${timestamp} - ${title}</div>
                <div class="result-content">${description}</div>
            `;
            
            container.insertBefore(resultItem, container.firstChild);
            
            // é™åˆ¶æ˜¾ç¤ºçš„ç»“æœæ•°é‡
            const items = container.querySelectorAll('.result-item');
            if (items.length > 10) {
                items[items.length - 1].remove();
            }
        }
    </script>
</body>
</html>